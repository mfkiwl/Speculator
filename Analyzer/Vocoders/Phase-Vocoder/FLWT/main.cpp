//
//  main.cpp
//
//
//  Created by Terry Kong on 2/22/15.
//
//

#include <stdio.h>
#include "FLWT.h"
#include <iostream>

using namespace std;

int windowLen = 512;
int data[1024] = {-2126,-2096,-2041,-2274,-2257,-2368,-2315,-2330,-2266,-2251,-2205,-2158,
    -2098,-2026,-1909,-1768,-1637,-1510,-1380,-1254,-1137,-1037,-950,-861,
    -841,-886,-937,-1101,-1279,-1443,-1671,-1810,-1829,-1837,-1758,-1595,
    -1466,-1331,-1206,-1136,-1089,-1095,-1135,-1149,-1175,-1210,-1195,-1155,
    -1097,-987,-885,-776,-609,-491,-387,-277,-202,-127,-53,3,
    47,130,219,317,448,559,671,786,827,822,824,780,
    711,647,563,513,469,424,374,299,209,96,-42,-227,
    -441,-682,-957,-1215,-1462,-1655,-1816,-1911,-1942,-1914,-1887,-1893,
    -1941,-2074,-2224,-2432,-2651,-2852,-2874,-2776,-2748,-2526,-2255,-2098,
    -1922,-1803,-1647,-1485,-1307,-1089,-880,-670,-498,-385,-326,-331,
    -338,-337,-336,-303,-249,-166,-75,11,109,226,360,516,
    684,871,1035,1153,1306,1437,1527,1629,1787,1902,2008,2108,
    2149,2152,2086,1990,1846,1715,1588,1469,1382,1304,1247,1198,
    1144,1112,1079,1027,961,864,757,644,494,395,288,162,
    64,-70,-218,-405,-646,-900,-1178,-1444,-1664,-1887,-2089,-2237,
    -2390,-2506,-2572,-2613,-2591,-2540,-2455,-2354,-2244,-2121,-2005,-1885,
    -1790,-1721,-1643,-1594,-1587,-1622,-1679,-1745,-1822,-1873,-1903,-1903,
    -1839,-1771,-1697,-1618,-1569,-1519,-1479,-1421,-1362,-1320,-1284,-1267,
    -1266,-1298,-1331,-1346,-1354,-1321,-1280,-1233,-1190,-1199,-1251,-1327,
    -1418,-1496,-1527,-1504,-1439,-1317,-1163,-1012,-855,-739,-630,-537,
    -430,-308,-204,-84,31,156,274,382,486,563,634,688,
    725,744,748,755,755,738,682,588,450,277,71,-140,
    -331,-473,-555,-601,-643,-709,-816,-992,-1221,-1495,-1764,-2019,
    -2221,-2379,-2490,-2562,-2608,-2597,-2565,-2489,-2384,-2257,-2119,-2010,
    -1935,-1914,-1936,-1959,-1962,-1914,-1805,-1636,-1436,-1228,-1027,-863,
    -721,-587,-443,-262,-55,166,389,587,740,843,918,968,
    1016,1074,1143,1221,1281,1325,1349,1339,1325,1318,1326,1363,
    1417,1478,1533,1576,1602,1595,1570,1530,1482,1432,1372,1308,
    1241,1177,1114,1053,998,937,873,806,721,624,518,396,
    262,115,-51,-231,-427,-629,-822,-1002,-1150,-1259,-1338,-1395,
    -1439,-1487,-1542,-1604,-1665,-1714,-1745,-1754,-1748,-1741,-1745,-1772,
    -1824,-1895,-1971,-2033,-2063,-2049,-1993,-1897,-1778,-1651,-1526,-1416,
    -1324,-1255,-1207,-1172,-1153,-1143,-1139,-1141,-1145,-1150,-1155,-1157,
    -1157,-1156,-1156,-1161,-1175,-1202,-1246,-1302,-1367,-1427,-1471,-1485,
    -1461,-1400,-1305,-1192,-1073,-961,-865,-786,-720,-664,-612,-560,
    -506,-447,-382,-304,-208,-90,48,196,341,467,566,634,
    682,724,779,854,946,1037,1104,1122,1078,978,840,698,
    584,520,510,538,578,599,581,518,418,299,178,62,
    -52,-181,-344,-551,-799,-1073,-1342,-1577,-1756,-1871,-1934,-1970,
    -2009,-2072,-2172,-2301,-2439,-2560,-2636,-2649,-2590,-2463,-2282,-2062,
    -1824,-1579,-1342,-1121,-917,-730,-558,-395,-235,-70,100,275,
    448,608,744,852,929,985,1031,1081,1149,1238,1345,1461,
    1571,1664,1735,1788,1832,1879,1937,2005,2076,2131,2148,2109,
    2006,1835,1612,1357,1096,855,652,500,404,360,358,382,
    414,432,419,365,270,144,6,-123,-223,-289,-326,-358,
    -411,-512,-675,-894,-1147,-1401,-1619,-1781,-1882,-1935,-1967,-2003,
    -2059,-2133,-2203,-2240,-2215,-2117,-1953,-1754,-1561,-1414,-1339,-1343,
    -1411,-1516,-1626,-1715,-1773,-1804,-1814,-1815,-1815,-1811,-1798,-1768,
    -1721,-1661,-1599,-1541,-1494,-1449,-1396,-1315,-1195,-1034,-845,-650,
    -479,-357,-295,-290,-320,-359,-383,-373,-328,-258,-181,-116,
    -74,-59,-63,-73,-75,-60,-25,29,95,170,254,349,
    460,588,731,878,1013,1120,1183,1195,1157,1078,973,858,
    745,641,544,450,351,242,122,-9,-143,-275,-398,-509,
    -604,-683,-748,-800,-841,-878,-918,-972,-1052,-1165,-1317,-1501,
    -1707,-1912,-2093,-2230,-2305,-2311,-2251,-2141,-1996,-1840,-1689,-1553,
    -1438,-1342,-1255,-1165,-1060,-933,-778,-599,-407,-217,-45,93,
    191,251,281,297,317,356,419,507,613,726,838,946,
    1052,1162,1279,1406,1533,1645,1729,1770,1760,1709,1632,1550,
    1488,1464,1482,1542,1629,1726,1816,1886,1929,1945,1933,1896,
    1835,1752,1651,1532,1404,1271,1134,993,842,670,467,227,
    -49,-349,-655,-941,-1186,-1377,-1509,-1589,-1629,-1642,-1639,-1620,
    -1583,-1526,-1447,-1353,-1262,-1196,-1174,-1210,-1307,-1457,-1639,-1831,
    -2015,-2176,-2309,-2415,-2498,-2558,-2593,-2598,-2567,-2494,-2380,-2228,
    -2045,-1839,-1613,-1373,-1129,-892,-681,-516,-415,-390,-439,-545,
    -681,-815,-920,-985,-1010,-1011,-1004,-1004,-1014,-1024,-1020,-983,
    -906,-793,-656,-520,-403,-316,-261,-229,-202,-167,-120,-58,
    11,79,142,198,250,305,364,423,480,528,561,571,
    565,542,505,457,400,335,266,199,140,94,66,44,
    15,-42,-144,-302,-515,-770,-1045,-1313,-1552,-1748,-1897,-2007,
    -2087,-2148,-2194,-2224,-2235,-2219,-2170,-2083,-1958,-1799,-1613,-1414,
    -1216,-1034,-882,-769,-697,-654,-625,-587,-519,-411,-262,-80,
    113,298,458,589,696,792,893,1007,1134,1264,1382,1476,
    1538,1570,1585,1605,1641,1701,1784,1879,1969,2038,2076,2084,
    2071,2051,2039,2044,2070,2117,2176,2240,2297,2336,2352,2332,
    2269,2160,2005,1811,1592,1369,1159,973,821,697,589,482,
    362,230,90,-46,-163,-254,-319,-365,-408,-465,-541,-640,
    -750,-862,-967,-1062,-1156,-1262,-1394,-1559,-1753,-1957,-2150,-2304,
    -2397,-2422,-2382,-2284,-2145,-1977,-1788,-1585,-1374,-1166,-973,-810,
    -693,-628,-614,-638,-680,-719,-740,-738,-715,-684,-661,-651,
    -658,-676,-696,-707,-706,-693,-672,-655,-654,-671,-710,-763,
    -824,-881,-927,-956,-966,-958,-937,-902,-858,-802,-731,-645,
    -540,-418,-285,-150,-21,93,190,275,357,447,554,679,
    814,943,1049,1110,1117,1069,971,836,674,499,315,131,
    -47,-207,-334,-418,-455,-447,-413,-380,-376,-420,-519,-669,
    -851,-1043,-1228,-1401,-1564,-1727,-1893,-2062,-2220,-2347,-2424,-2434,
    -2376,-2263,-2113,-1942};
int data2[1024] = {-1768,-1594,-1417,-1233,-1038,-838,-647,-481,-351,-260,-201,-156,
    -106,-36,59,182,325,479,642,815,1000,1197,1401,1595,
    1761,1881,1943,1953,1926,1888,1868,1883,1939,2027,2125,2206,
    2246,2233,2165,2053,1918,1779,1653,1550,1473,1412,1353,1286,
    1193,1077,944,808,688,602,558,551,563,568,539,459,
    325,150,-45,-230,-389,-517,-622,-727,-853,-1014,-1205,-1410,
    -1602,-1754,-1844,-1869,-1840,-1776,-1696,-1619,-1549,-1485,-1423,-1354,
    -1283,-1219,-1174,-1163,-1194,-1262,-1356,-1460,-1553,-1620,-1651,-1645,
    -1606,-1545,-1471,-1392,-1316,-1245,-1181,-1122,-1067,-1012,-954,-893,
    -829,-765,-704,-653,-614,-593,-587,-595,-617,-650,-695,-750,
    -810,-870,-919,-946,-936,-882,-781,-635,-457,-258,-53,144,
    324,481,612,715,791,842,872,886,887,883,876,870,
    865,863,862,862,866,872,878,880,870,841,784,698,
    588,463,336,218,114,23,-71,-180,-320,-501,-723,-975,
    -1239,-1493,-1721,-1910,-2054,-2161,-2233,-2281,-2312,-2325,-2322,-2302,
    -2259,-2191,-2096,-1973,-1824,-1647,-1452,-1246,-1037,-842,-671,-534,
    -432,-367,-330,-307,-285,-250,-189,-95,35,198,386,588,
    792,987,1165,1323,1461,1584,1698,1805,1906,1997,2072,2125,
    2156,2166,2161,2153,2150,2158,2172,2188,2195,2182,2146,2089,
    2019,1944,1877,1819,1767,1713,1648,1562,1448,1308,1147,971,
    788,604,422,244,72,-95,-257,-417,-578,-743,-914,-1089,
    -1259,-1416,-1541,-1625,-1660,-1647,-1597,-1528,-1460,-1410,-1388,-1391,
    -1414,-1441,-1458,-1455,-1425,-1372,-1301,-1225,-1156,-1101,-1068,-1057,
    -1063,-1083,-1108,-1125,-1129,-1118,-1094,-1065,-1045,-1043,-1067,-1117,
    -1184,-1253,-1309,-1337,-1329,-1283,-1208,-1113,-1008,-899,-792,-686,
    -585,-491,-413,-359,-339,-356,-404,-473,-549,-612,-649,-651,
    -620,-556,-468,-361,-236,-94,65,242,428,615,790,942,
    1066,1159,1220,1253,1258,1232,1176,1084,964,828,691,572,
    484,430,400,370,318,220,72,-121,-336,-540,-710,-831,
    -907,-951,-989,-1044,-1126,-1237,-1362,-1486,-1592,-1672,-1729,-1770,
    -1803,-1834,-1858,-1869,-1856,-1817,-1756,-1688,-1633,-1603,-1602,-1619,
    -1627,-1595,-1497,-1320,-1070,-770,-455,-158,96,304,474,623,
    774,939,1117,1295,1456,1582,1665,1707,1719,1717,1720,1736,
    1767,1811,1868,1936,2016,2112,2225,2345,2456,2537,2569,2544,
    2464,2346,2213,2086,1975,1879,1787,1678,1546,1392,1230,1084,
    967,884,819,748,642,484,279,53,-155,-307,-381,-387,
    -350,-320,-338,-424,-581,-783,-992,-1178,-1328,-1441,-1535,-1624,
    -1716,-1804,-1868,-1887,-1852,-1774,-1680,-1606,-1579,-1610,-1683,-1763,
    -1811,-1797,-1711,-1570,-1407,-1258,-1151,-1092,-1070,-1063,-1044,-1000,
    -929,-841,-745,-644,-536,-409,-252,-69,132,320,463,531,
    513,415,262,87,-75,-202,-283,-325,-339,-339,-335,-326,
    -308,-272,-207,-111,19,179,360,549,733,896,1028,1118,
    1171,1194,1198,1197,1196,1192,1174,1127,1034,895,715,513,
    317,150,29,-45,-80,-92,-95,-98,-99,-90,-70,-40,
    -12,-9,-57,-172,-362,-615,-909,-1214,-1500,-1748,-1947,-2099,
    -2208,-2284,-2332,-2350,-2340,-2299,-2230,-2138,-2032,-1919,-1804,-1683,
    -1552,-1405,-1236,-1050,-855,-668,-504,-379,-303,-273,-275,-290,
    -291,-257,-168,-22,171,394,622,830,1007,1149,1265,1369,
    1477,1597,1725,1846,1940,1991,1990,1943,1867,1788,1731,1711,
    1735,1788,1862,1936,2004,2064,2119,2171,2219,2257,2269,2244,
    2179,2075,1947,1813,1689,1579,1480,1375,1244,1071,855,610,
    359,130,-57,-193,-284,-345,-394,-447,-508,-572,-633,-685,
    -731,-782,-856,-969,-1126,-1324,-1544,-1755,-1931,-2050,-2104,-2100,
    -2054,-1987,-1917,-1852,-1795,-1740,-1680,-1614,-1542,-1468,-1402,-1347,
    -1304,-1263,-1215,-1154,-1074,-984,-898,-832,-803,-820,-877,-953,
    -1024,-1058,-1034,-941,-785,-594,-397,-226,-108,-49,-42,-65,
    -86,-81,-31,65,190,326,443,520,550,536,494,445,
    409,399,415,453,504,560,619,684,765,866,990,1125,
    1251,1342,1375,1331,1211,1022,785,528,274,38,-167,-340,
    -483,-597,-687,-752,-794,-821,-846,-879,-933,-1015,-1122,-1245,
    -1369,-1481,-1574,-1648,-1706,-1756,-1803,-1844,-1869,-1867,-1828,-1750,
    -1638,-1510,-1385,-1277,-1195,-1135,-1084,-1028,-954,-855,-731,-591,
    -437,-274,-104,78,269,468,661,833,972,1071,1133,1172,
    1210,1268,1357,1477,1612,1745,1853,1927,1966,1985,2001,2032,
    2087,2165,2255,2342,2411,2458,2480,2488,2488,2482,2467,2429,
    2357,2238,2075,1878,1668,1471,1306,1187,1108,1054,1006,945,
    860,751,627,502,388,283,181,70,-73,-255,-479,-729,
    -981,-1212,-1396,-1523,-1592,-1617,-1616,-1609,-1607,-1613,-1623,-1628,
    -1622,-1604,-1580,-1557,-1547,-1556,-1580,-1610,-1628,-1622,-1579,-1496,
    -1381,-1249,-1117,-1002,-915,-856,-820,-794,-766,-724,-665,-587,
    -501,-416,-347,-307,-302,-333,-394,-473,-553,-616,-646,-634,
    -577,-484,-366,-239,-122,-24,50,106,150,194,246,307,
    376,439,486,508,505,486,467,467,503,581,698,835,
    974,1093,1178,1226,1241,1237,1224,1208,1189,1154,1090,991,
    852,683,498,310,130,-40,-206,-380,-572,-786,-1020,-1261,
    -1498,-1717,-1913,-2084,-2234,-2365,-2472,-2550,-2584,-2565,-2492,-2372,
    -2227,-2082,-1961,-1877,-1826,-1795,-1761,-1698,-1593,-1446,-1273,-1097,
    -944,-832,-765,-731,-708,-672,-596,-469,-289,-61,198,471,
    742,998,1231,1434,1607,1751,1867,1958,2024,2066,2080,2064,
    2013,1930,1817,1684,1554,1444,1376,1363,1406,1498,1618,1745,
    1859,1948,2004,2025,2023,1999,1953,1881,1775,1633,1457,1259,
    1059,880,737,637,576,536,489,415,296,129,-78,-305,
    -529,-731,-901,-1033,-1130,-1202,-1256,-1298,-1334,-1373,-1420,-1478,
    -1556,-1654,-1771,-1893,-2009,-2100,-2152,-2159,-2118,-2040,-1932,-1810,
    -1684,-1559,-1437,-1318,-1201,-1089,-986,-897,-829,-787,-769,-768,
    -773,-774,-760,-725};
int data3[512] = {-2126,-2096,-2041,-2274,-2257,-2368,-2315,-2330,-2266,-2251,-2205,-2158,
    -2098,-2026,-1909,-1768,-1637,-1510,-1380,-1254,-1137,-1037,-950,-861,
    -841,-886,-937,-1101,-1279,-1443,-1671,-1810,-1829,-1837,-1758,-1595,
    -1466,-1331,-1206,-1136,-1089,-1095,-1135,-1149,-1175,-1210,-1195,-1155,
    -1097,-987,-885,-776,-609,-491,-387,-277,-202,-127,-53,3,
    47,130,219,317,448,559,671,786,827,822,824,780,
    711,647,563,513,469,424,374,299,209,96,-42,-227,
    -441,-682,-957,-1215,-1462,-1655,-1816,-1911,-1942,-1914,-1887,-1893,
    -1941,-2074,-2224,-2432,-2651,-2852,-2874,-2776,-2748,-2526,-2255,-2098,
    -1922,-1803,-1647,-1485,-1307,-1089,-880,-670,-498,-385,-326,-331,
    -338,-337,-336,-303,-249,-166,-75,11,109,226,360,516,
    684,871,1035,1153,1306,1437,1527,1629,1787,1902,2008,2108,
    2149,2152,2086,1990,1846,1715,1588,1469,1382,1304,1247,1198,
    1144,1112,1079,1027,961,864,757,644,494,395,288,162,
    64,-70,-218,-405,-646,-900,-1178,-1444,-1664,-1887,-2089,-2237,
    -2390,-2506,-2572,-2613,-2591,-2540,-2455,-2354,-2244,-2121,-2005,-1885,
    -1790,-1721,-1643,-1594,-1587,-1622,-1679,-1745,-1822,-1873,-1903,-1903,
    -1839,-1771,-1697,-1618,-1569,-1519,-1479,-1421,-1362,-1320,-1284,-1267,
    -1266,-1298,-1331,-1346,-1354,-1321,-1280,-1233,-1190,-1199,-1251,-1327,
    -1418,-1496,-1527,-1504,-1439,-1317,-1163,-1012,-855,-739,-630,-537,
    -430,-308,-204,-84,31,156,274,382,486,563,634,688,
    725,744,748,755,755,738,682,588,450,277,71,-140,
    -331,-473,-555,-601,-643,-709,-816,-992,-1221,-1495,-1764,-2019,
    -2221,-2379,-2490,-2562,-2608,-2597,-2565,-2489,-2384,-2257,-2119,-2010,
    -1935,-1914,-1936,-1959,-1962,-1914,-1805,-1636,-1436,-1228,-1027,-863,
    -721,-587,-443,-262,-55,166,389,587,740,843,918,968,
    1016,1074,1143,1221,1281,1325,1349,1339,1325,1318,1326,1363,
    1417,1478,1533,1576,1602,1595,1570,1530,1482,1432,1372,1308,
    1241,1177,1114,1053,998,937,873,806,721,624,518,396,
    262,115,-51,-231,-427,-629,-822,-1002,-1150,-1259,-1338,-1395,
    -1439,-1487,-1542,-1604,-1665,-1714,-1745,-1754,-1748,-1741,-1745,-1772,
    -1824,-1895,-1971,-2033,-2063,-2049,-1993,-1897,-1778,-1651,-1526,-1416,
    -1324,-1255,-1207,-1172,-1153,-1143,-1139,-1141,-1145,-1150,-1155,-1157,
    -1157,-1156,-1156,-1161,-1175,-1202,-1246,-1302,-1367,-1427,-1471,-1485,
    -1461,-1400,-1305,-1192,-1073,-961,-865,-786,-720,-664,-612,-560,
    -506,-447,-382,-304,-208,-90,48,196,341,467,566,634,
    682,724,779,854,946,1037,1104,1122,1078,978,840,698,
    584,520,510,538,578,599,581,518,418,299,178,62,
    -52,-181,-344,-551,-799,-1073,-1342,-1577,-1756,-1871,-1934,-1970,
    -2009,-2072,-2172,-2301,-2439,-2560,-2636,-2649,-2590,-2463,-2282,-2062,
    -1824,-1579,-1342,-1121,-917,-730,-558,-395,-235,-70,100,275,
    448,608,744,852,929,985,1031,1081,1149,1238,1345,1461,
    1571,1664,1735,1788,1832,1879,1937,2005};

// Return median
float median5(float*_medianBuffer5) {
    float a = _medianBuffer5[0];
    float b = _medianBuffer5[1];
    float c = _medianBuffer5[2];
    float d = _medianBuffer5[3];
    float e = _medianBuffer5[4];
    // Put the largest value in a
    if (a <= b) { a = a+b; b = a-b; a = a-b; }
    if (a <= c) { a = a+c; c = a-c; a = a-c; }
    if (a <= d) { a = a+d; d = a-d; a = a-d; }
    if (a <= e) { a = a+e; e = a-e; a = a-e; }
    // Put the second largest value in b
    if (b <= c) { b = b+c; c = b-c; b = b-c; }
    if (b <= d) { b = b+d; d = b-d; b = b-d; }
    if (b <= e) { b = b+e; e = b-e; b = b-e; }
    // The 3rd largest is the median
    if (c <= d) { c = c+d; d = c-d; c = c-d; }
    if (c <= e) { c = c+e; e = c-e; c = c-e; }
    return c;
}

int main() {
    cout<<endl<<"FLWT Testing: "<<endl<<endl;
    int levels = 6;
    long fs = 48000;
    FLWT flwt(levels,windowLen);
    float freq = flwt.getPitch(data3,windowLen,fs);
    
    cout<<endl<<"freq = " <<freq<<endl<<endl;
    
    float nums[] = {32,122,722,423,123};
    cout<<endl<<"median= " <<median5(nums)<<endl<<endl;
    
    return 0;
}